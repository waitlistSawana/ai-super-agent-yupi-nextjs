{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "sealos-ai-provider",
  "type": "registry:lib",
  "title": "Sealos AI provider for ai sdk",
  "description": "Set up Sealos AI provider for ai sdk. Add model provider to lib. Build with ai-sdk/openai-compatible",
  "dependencies": [
    "@ai-sdk/openai-compatible",
    "@ai-sdk/provider",
    "@ai-sdk/provider-utils"
  ],
  "files": [
    {
      "path": "src/lib/ai/providers/sealos.ts",
      "content": "/**\n * Sealos AI 提供商 for AI SDK\n *\n * @author Sawana Huang\n * @date 2025-04-25\n *\n * @description 基于 OpenAI 兼容的 API 实现\n *\n * @see https://sealos.run/docs/guides/ai-proxy\n * @see https://sdk.vercel.ai/providers/openai-compatible-providers/custom-providers\n *\n * IMPORTANT:\n * - The model ids should be defined manually\n * - Model id types: chat, completion, embedding, and image\n * - Add \"DASHSCOPE_API_KEY\" in your .env file\n */\n\n/**\n * Set up the base URL and environment variable name\n */\nexport const SEALOS_BASE_URL = \"https://aiproxy.hzh.sealos.run/v1\";\nexport const SEALOS_ENVIRONMENT_VARIABLE_NAME = \"SEALOS_API_KEY\";\n\n/**\n * 1. Define chat model IDs and settings\n * example-chat-settings.ts\n *\n */\nimport { type OpenAICompatibleChatSettings } from \"@ai-sdk/openai-compatible\";\n\nexport type SealosChatModelId =\n  | \"deepseek-chat\"\n  | \"deepseek-chat-0324\"\n  | \"deepseek-reasoner\"\n  | (string & {});\n\nexport interface SealosChatSettings extends OpenAICompatibleChatSettings {\n  // Specific settings\n  sealos?: string;\n}\n\nexport type SealosCompletionModelId = string & {};\n\nexport interface SealosCompletionSettings extends OpenAICompatibleChatSettings {\n  // Specific settings\n  sealos?: string;\n}\n\nexport type SealosEmbeddingModelId = string & {};\n\nexport interface SealosEmbeddingSettings extends OpenAICompatibleChatSettings {\n  // Specific settings\n  sealos?: string;\n}\n\nexport type SealosImageModelId = string & {};\n\nexport interface SealosImageSettings extends OpenAICompatibleChatSettings {\n  // Specific settings\n  sealos?: string;\n}\n\n/**\n * 2. Main provider implementation\n * example-provider.ts\n */\nimport type {\n  LanguageModelV1,\n  EmbeddingModelV1,\n  ImageModelV1,\n} from \"@ai-sdk/provider\";\nimport {\n  OpenAICompatibleChatLanguageModel,\n  OpenAICompatibleCompletionLanguageModel,\n  OpenAICompatibleEmbeddingModel,\n  OpenAICompatibleImageModel,\n} from \"@ai-sdk/openai-compatible\";\nimport {\n  type FetchFunction,\n  loadApiKey,\n  withoutTrailingSlash,\n} from \"@ai-sdk/provider-utils\";\n// Import your model id and settings here.\n\ninterface SealosProviderSettings {\n  /**\nExample API key.\n*/\n  apiKey?: string;\n  /**\nBase URL for the API calls.\n*/\n  baseURL?: string;\n  /**\nCustom headers to include in the requests.\n*/\n  headers?: Record<string, string>;\n  /**\nOptional custom url query parameters to include in request urls.\n*/\n  queryParams?: Record<string, string>;\n  /**\nCustom fetch implementation. You can use it as a middleware to intercept requests,\nor to provide a custom fetch implementation for e.g. testing.\n*/\n  fetch?: FetchFunction;\n}\n\ninterface SealosProvider {\n  /**\nCreates a model for text generation.\n*/\n  (modelId: SealosChatModelId, settings?: SealosChatSettings): LanguageModelV1;\n\n  /**\nCreates a chat model for text generation.\n*/\n  chatModel(\n    modelId: SealosChatModelId,\n    settings?: SealosChatSettings,\n  ): LanguageModelV1;\n\n  /**\nCreates a completion model for text generation.\n*/\n  completionModel(\n    modelId: SealosCompletionModelId,\n    settings?: SealosCompletionSettings,\n  ): LanguageModelV1;\n\n  /**\nCreates a text embedding model for text generation.\n*/\n  textEmbeddingModel(\n    modelId: SealosEmbeddingModelId,\n    settings?: SealosEmbeddingSettings,\n  ): EmbeddingModelV1<string>;\n\n  /**\nCreates an image model for image generation.\n*/\n  imageModel(\n    modelId: SealosImageModelId,\n    settings?: SealosImageSettings,\n  ): ImageModelV1;\n}\n\nfunction createSealos(options: SealosProviderSettings = {}): SealosProvider {\n  const baseURL = withoutTrailingSlash(options.baseURL ?? SEALOS_BASE_URL);\n  const getHeaders = () => ({\n    Authorization: `Bearer ${loadApiKey({\n      apiKey: options.apiKey,\n      environmentVariableName: SEALOS_ENVIRONMENT_VARIABLE_NAME,\n      description: \"Sealos API key\",\n    })}`,\n    ...options.headers,\n  });\n\n  interface CommonModelConfig {\n    provider: string;\n    url: ({ path }: { path: string }) => string;\n    headers: () => Record<string, string>;\n    fetch?: FetchFunction;\n  }\n\n  const getCommonModelConfig = (modelType: string): CommonModelConfig => ({\n    provider: `example.${modelType}`,\n    url: ({ path }) => {\n      const url = new URL(`${baseURL}${path}`);\n      if (options.queryParams) {\n        url.search = new URLSearchParams(options.queryParams).toString();\n      }\n      return url.toString();\n    },\n    headers: getHeaders,\n    fetch: options.fetch,\n  });\n\n  const createChatModel = (\n    modelId: SealosChatModelId,\n    settings: SealosChatSettings = {},\n  ) => {\n    return new OpenAICompatibleChatLanguageModel(modelId, settings, {\n      ...getCommonModelConfig(\"chat\"),\n      defaultObjectGenerationMode: \"tool\",\n    });\n  };\n\n  const createCompletionModel = (\n    modelId: SealosCompletionModelId,\n    settings: SealosCompletionSettings = {},\n  ) =>\n    new OpenAICompatibleCompletionLanguageModel(\n      modelId,\n      settings,\n      getCommonModelConfig(\"completion\"),\n    );\n\n  const createTextEmbeddingModel = (\n    modelId: SealosEmbeddingModelId,\n    settings: SealosEmbeddingSettings = {},\n  ) =>\n    new OpenAICompatibleEmbeddingModel(\n      modelId,\n      settings,\n      getCommonModelConfig(\"embedding\"),\n    );\n\n  const createImageModel = (\n    modelId: SealosImageModelId,\n    settings: SealosImageSettings = {},\n  ) =>\n    new OpenAICompatibleImageModel(\n      modelId,\n      settings,\n      getCommonModelConfig(\"image\"),\n    );\n\n  const provider = (\n    modelId: SealosChatModelId,\n    settings?: SealosChatSettings,\n  ) => createChatModel(modelId, settings);\n\n  provider.completionModel = createCompletionModel;\n  provider.chatModel = createChatModel;\n  provider.textEmbeddingModel = createTextEmbeddingModel;\n  provider.imageModel = createImageModel;\n\n  return provider;\n}\n\n// Export default instance\nconst sealos = createSealos();\n\n/**\n * 3. Public exports\n * index.ts\n */\nexport type { SealosProvider, SealosProviderSettings };\nexport { createSealos, sealos };\n",
      "type": "registry:lib",
      "target": "./lib/ai/providers/sealos.ts"
    }
  ]
}